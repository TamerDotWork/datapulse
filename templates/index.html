<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Clustering App</title>
    <link rel="stylesheet" href="static/css/style.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="static/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/favicon-16x16.png">
    <link rel="manifest" href="static/site.webmanifest">
</head>
<body>
                         <div id="loading-overlay" style="display:none; ">
            <div id="errorIcon"  ><img id="danger" src="static/danger.svg" alt=""></div>
            <img id="preloader" src="static/preloader.gif" alt="">
            <div id="progressContainer"></div>

            <div id="errorContainer">
                <div id="errorMsg"  ></div>
                <a href="." id="refresh">Try again</a>
            </div>
            
            
        </div>
<div class="container">
        <div class="wrapper">
            <side>
                <a href="#" class="logo-image"><img src="static/logo.png" alt=""></a>
                <a href="" class="settings" >

<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 15.75C9.93 15.75 8.25 14.07 8.25 12C8.25 9.93 9.93 8.25 12 8.25C14.07 8.25 15.75 9.93 15.75 12C15.75 14.07 14.07 15.75 12 15.75ZM12 9.75C10.76 9.75 9.75 10.76 9.75 12C9.75 13.24 10.76 14.25 12 14.25C13.24 14.25 14.25 13.24 14.25 12C14.25 10.76 13.24 9.75 12 9.75Z" fill="white"/>
<path d="M15.21 22.19C15 22.19 14.79 22.16 14.58 22.11C13.96 21.94 13.44 21.55 13.11 21L12.99 20.8C12.4 19.78 11.59 19.78 11 20.8L10.89 20.99C10.56 21.55 10.04 21.95 9.42 22.11C8.79 22.28 8.14 22.19 7.59 21.86L5.87 20.87C5.26 20.52 4.82 19.95 4.63 19.26C4.45 18.57 4.54 17.86 4.89 17.25C5.18 16.74 5.26 16.28 5.09 15.99C4.92 15.7 4.49 15.53 3.9 15.53C2.44 15.53 1.25 14.34 1.25 12.88V11.12C1.25 9.66004 2.44 8.47004 3.9 8.47004C4.49 8.47004 4.92 8.30004 5.09 8.01004C5.26 7.72004 5.19 7.26004 4.89 6.75004C4.54 6.14004 4.45 5.42004 4.63 4.74004C4.81 4.05004 5.25 3.48004 5.87 3.13004L7.6 2.14004C8.73 1.47004 10.22 1.86004 10.9 3.01004L11.02 3.21004C11.61 4.23004 12.42 4.23004 13.01 3.21004L13.12 3.02004C13.8 1.86004 15.29 1.47004 16.43 2.15004L18.15 3.14004C18.76 3.49004 19.2 4.06004 19.39 4.75004C19.57 5.44004 19.48 6.15004 19.13 6.76004C18.84 7.27004 18.76 7.73004 18.93 8.02004C19.1 8.31004 19.53 8.48004 20.12 8.48004C21.58 8.48004 22.77 9.67004 22.77 11.13V12.89C22.77 14.35 21.58 15.54 20.12 15.54C19.53 15.54 19.1 15.71 18.93 16C18.76 16.29 18.83 16.75 19.13 17.26C19.48 17.87 19.58 18.59 19.39 19.27C19.21 19.96 18.77 20.53 18.15 20.88L16.42 21.87C16.04 22.08 15.63 22.19 15.21 22.19ZM12 18.49C12.89 18.49 13.72 19.05 14.29 20.04L14.4 20.23C14.52 20.44 14.72 20.59 14.96 20.65C15.2 20.71 15.44 20.68 15.64 20.56L17.37 19.56C17.63 19.41 17.83 19.16 17.91 18.86C17.99 18.56 17.95 18.25 17.8 17.99C17.23 17.01 17.16 16 17.6 15.23C18.04 14.46 18.95 14.02 20.09 14.02C20.73 14.02 21.24 13.51 21.24 12.87V11.11C21.24 10.48 20.73 9.96004 20.09 9.96004C18.95 9.96004 18.04 9.52004 17.6 8.75004C17.16 7.98004 17.23 6.97004 17.8 5.99004C17.95 5.73004 17.99 5.42004 17.91 5.12004C17.83 4.82004 17.64 4.58004 17.38 4.42004L15.65 3.43004C15.22 3.17004 14.65 3.32004 14.39 3.76004L14.28 3.95004C13.71 4.94004 12.88 5.50004 11.99 5.50004C11.1 5.50004 10.27 4.94004 9.7 3.95004L9.59 3.75004C9.34 3.33004 8.78 3.18004 8.35 3.43004L6.62 4.43004C6.36 4.58004 6.16 4.83004 6.08 5.13004C6 5.43004 6.04 5.74004 6.19 6.00004C6.76 6.98004 6.83 7.99004 6.39 8.76004C5.95 9.53004 5.04 9.97004 3.9 9.97004C3.26 9.97004 2.75 10.48 2.75 11.12V12.88C2.75 13.51 3.26 14.03 3.9 14.03C5.04 14.03 5.95 14.47 6.39 15.24C6.83 16.01 6.76 17.02 6.19 18C6.04 18.26 6 18.57 6.08 18.87C6.16 19.17 6.35 19.41 6.61 19.57L8.34 20.56C8.55 20.69 8.8 20.72 9.03 20.66C9.27 20.6 9.47 20.44 9.6 20.23L9.71 20.04C10.28 19.06 11.11 18.49 12 18.49Z" fill="white"/>
</svg>

                </a>
                
            </side>

            <main>
                <span class="logo-text">Data Pulse</span>
                <div class="wrap">

            <form id="trainForm" method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <button class="btn primary-btn"  type="button" id="btnTrain">
                       
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path opacity="0.4" d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="#7DB7FF"/>
<path d="M15.53 10.97L12.53 7.97C12.24 7.68 11.76 7.68 11.47 7.97L8.47 10.97C8.18 11.26 8.18 11.74 8.47 12.03C8.76 12.32 9.24 12.32 9.53 12.03L11.25 10.31V15.5C11.25 15.91 11.59 16.25 12 16.25C12.41 16.25 12.75 15.91 12.75 15.5V10.31L14.47 12.03C14.62 12.18 14.81 12.25 15 12.25C15.19 12.25 15.38 12.18 15.53 12.03C15.82 11.74 15.82 11.26 15.53 10.97Z" fill="#7DB7FF"/>
</svg>

                        Upload dataset</button>
                    <input type="file" id="trainFile" accept=".csv" required name="file"  style="display: none;">
</form>
                <small>Customer Classification Model v1.0</small>
                <h1>Unleash the power of algorithmic prediction</h1>
                <h2>Smarter, Faster & Better</h2>
                <p>Transform your business with cutting-edge algorithmic prediction. automate tasks, enhance decision-making, and unlock new possibilities with our intelligent, adaptive model.</p>
                </div>
            <div  class="copy">Â© 2026 Data Pulse. All Rights Reserved</div>
            </main>

        </div>
</div>
    <script src="static/js/jquery-3.6.0.min.js"></script>
<script>
     $(document).ready(function() {
            $('#btnTrain').on('click', function() {
                $('#trainFile').click();
            });

            $('#trainFile').on('change', function() {
                $('#trainForm').submit();
            });
        });

           $('#trainForm').on('submit', async function(e) {
           e.preventDefault();
    // $('body').css('filter', 'blur(8px)');
 
            const errorDiv = document.getElementById('errorMsg');
            const errorContainer = document.getElementById('errorContainer');
            const loader = document.getElementById('loading-overlay');
            const errorIcon = document.getElementById('errorIcon');
            const preloaderIcon = document.getElementById('preloader');
            const progressContainer = document.getElementById('progressContainer');
            
            const newString = "Training in progress... This may take a few minutes.";
            progressContainer.textContent = newString;
 
            loader.style.display = 'block';
            errorDiv.style.display = 'none';
            errorContainer.style.display = 'none';
            errorIcon.style.display = 'none';
            preloaderIcon.style.display = 'block';

            const fileInput = document.getElementById('trainFile');
            const btnTrain = document.getElementById('btnTrain');
  

            

 
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            try {   
                // FIX: Use 'upload' (relative) instead of '/upload' (absolute)
                const response = await fetch('api/train', {
                    method: 'POST',
                    body: formData
                });

                // Read text first to catch HTML errors (like 404/500)
                const responseText = await response.text();
                
                 let result;
                try {
                    result = JSON.parse(responseText);
                } catch (err) {
                     
                    console.error("Server HTML Response:", responseText);
                    throw new Error(`Server returned error (${response.status}). See console.`);
                }

                if (!response.ok || result.error) {
                  
                    throw new Error(result.error || "Unknown Server Error");
                }

                //   $('main,header').css('filter', 'none');
                sessionStorage.setItem('dqResult', JSON.stringify(result));
                window.location.href = "result?success=true"; // Relative redirect

            } catch (err) {
 
                console.log(err.message);
 
            }
    });
</script>
</body>
</html>